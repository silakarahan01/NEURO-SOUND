{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    .glass-form {
        background: rgba(30, 30, 30, 0.6);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
</style>

<div class="min-h-screen py-20 px-4 flex items-center justify-center">
    <div
        class="glass-form p-8 rounded-3xl w-full max-w-4xl grid grid-cols-1 lg:grid-cols-2 gap-12 relative overflow-hidden">

        <!-- Sol Taraf: Plan Özeti -->
        <div class="relative z-10 flex flex-col justify-center">
            <h2
                class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-violet-400 to-emerald-400 mb-2">
                Abonelik Yenileme
            </h2>
            <p class="text-stone-400 mb-8 text-sm">Kesintisiz hizmet için aboneliğinizi uzatın.</p>

            <div class="bg-stone-800/50 p-6 rounded-2xl border border-white/5 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <span class="text-stone-300 font-bold">Seçilen Plan</span>
                    <span
                        class="text-emerald-400 text-sm font-bold bg-emerald-900/20 px-3 py-1 rounded-full border border-emerald-500/20">
                        {{ plan.get_name_display }}
                    </span>
                </div>
                <div class="flex items-end gap-2 mb-2">
                    <span class="text-4xl font-bold text-white">{{ plan.price }} TL</span>
                    <span class="text-stone-500 mb-1">/ Aylık</span>
                </div>
                <ul class="text-sm text-stone-400 space-y-2 mt-4">
                    <li class="flex items-center gap-2"><i class="fas fa-check text-emerald-500"></i> Tüm modüllere
                        erişim</li>
                    <li class="flex items-center gap-2"><i class="fas fa-check text-emerald-500"></i> 7/24 Teknik Destek
                    </li>
                    <li class="flex items-center gap-2"><i class="fas fa-check text-emerald-500"></i> Güvenli Ödeme</li>
                </ul>
            </div>

            <div class="text-xs text-stone-500">
                <p>Güvenli ödeme altyapımız ile bilgileriniz şifrelenerek korunmaktadır.</p>
            </div>
        </div>

        <!-- Sağ Taraf: Ödeme Formu (Mock) -->
        <div class="relative z-10">
            <div
                class="bg-gradient-to-br from-violet-600 to-purple-800 rounded-2xl p-6 mb-8 shadow-2xl transform rotate-1 hover:rotate-0 transition-all duration-500">
                <div class="flex justify-between items-start mb-8">
                    <div class="w-12 h-8 bg-yellow-400/80 rounded-md"></div>
                    <i class="fas fa-wifi text-white/50 rotate-90"></i>
                </div>
                <div class="mb-6">
                    <div class="text-white/80 text-xs mb-1">Kart Numarası</div>
                    <div id="displayCardNumber" class="text-white text-xl font-mono tracking-widest">**** **** **** 4242
                    </div>
                </div>
                <div class="flex justify-between">
                    <div>
                        <div class="text-white/80 text-xs mb-1">Kart Sahibi</div>
                        <div id="displayCardHolder" class="text-white text-sm font-medium tracking-wide uppercase">AD
                            SOYAD</div>
                    </div>
                    <div>
                        <div class="text-white/80 text-xs mb-1">SKT</div>
                        <div id="displayCardExpiry" class="text-white text-sm font-medium tracking-wide">MM/YY</div>
                    </div>
                </div>
            </div>

            <form method="POST" class="space-y-4">
                {% csrf_token %}

                {% if messages %}
                <div class="mb-4">
                    {% for message in messages %}
                    <div
                        class="p-3 rounded-lg text-sm {% if message.tags == 'success' %}bg-emerald-500/20 text-emerald-400{% else %}bg-red-500/20 text-red-400{% endif %}">
                        {{ message }}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <div>
                    <label class="block text-stone-400 text-xs font-bold mb-2 ml-1">KART SAHİBİ</label>
                    <input type="text" id="inputCardHolder" placeholder="Ad Soyad"
                        class="w-full bg-stone-900/50 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-violet-500 transition-colors"
                        required>
                </div>

                <div>
                    <label class="block text-stone-400 text-xs font-bold mb-2 ml-1">KART NUMARASI</label>
                    <input type="text" id="inputCardNumber" placeholder="0000 0000 0000 0000"
                        class="w-full bg-stone-900/50 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-violet-500 transition-colors"
                        maxlength="19" required>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-stone-400 text-xs font-bold mb-2 ml-1">SON KULLANMA</label>
                        <input type="text" id="inputExpiry" placeholder="AA/YY"
                            class="w-full bg-stone-900/50 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-violet-500 transition-colors"
                            maxlength="5" required>
                    </div>
                    <div>
                        <label class="block text-stone-400 text-xs font-bold mb-2 ml-1">CVV</label>
                        <input type="text" id="inputCVV" placeholder="123"
                            class="w-full bg-stone-900/50 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-violet-500 transition-colors"
                            maxlength="3" required>
                    </div>
                </div>

                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        const inputName = document.getElementById('inputCardHolder');
                        const displayName = document.getElementById('displayCardHolder');

                        const inputNumber = document.getElementById('inputCardNumber');
                        const displayNumber = document.getElementById('displayCardNumber');

                        const inputExpiry = document.getElementById('inputExpiry');
                        const displayExpiry = document.getElementById('displayCardExpiry');

                        // İsim Güncelleme
                        inputName.addEventListener('input', function (e) {
                            displayName.textContent = e.target.value.toUpperCase() || 'AD SOYAD';
                        });

                        // Numara Formatlama ve Güncelleme
                        inputNumber.addEventListener('input', function (e) {
                            let value = e.target.value.replace(/\D/g, '').substring(0, 16);
                            let formatted = '';
                            for (let i = 0; i < value.length; i++) {
                                if (i > 0 && i % 4 === 0) formatted += ' ';
                                formatted += value[i];
                            }
                            e.target.value = formatted;
                            displayNumber.textContent = formatted || '**** **** **** ****';
                        });

                        // Tarih Formatlama
                        inputExpiry.addEventListener('input', function (e) {
                            let value = e.target.value.replace(/\D/g, '').substring(0, 4);
                            if (value.length >= 2) {
                                value = value.substring(0, 2) + '/' + value.substring(2);
                            }
                            e.target.value = value;
                            displayExpiry.textContent = value || 'AA/YY';
                        });
                    });
                </script>

                <button type="submit"
                    class="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-emerald-500/20 transition-all transform active:scale-95 mt-4">
                    <i class="fas fa-lock mr-2"></i> {{ plan.price }} TL ÖDE
                </button>
            </form>
        </div>

        <!-- Glow Effect -->
        <div
            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-violet-600/20 rounded-full blur-[100px] -z-10 pointer-events-none">
        </div>
    </div>
</div>
{% endblock %}